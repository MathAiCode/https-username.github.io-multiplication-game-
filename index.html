<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Ø§Ù„ØªÙ‚Ø±ÙŠØ¨ Ù„Ù„ØµÙ Ø§Ù„Ø«Ø§Ù…Ù† â€“ Ø·Ø§Ø¨Ù‚ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª</title>
  <style>
    /* ---------- Responsive layout tuned for phones ---------- */
    :root {
      --gap: 10px;
      --pad: 10px;
      --card-pad: 10px;
      --card-radius: 12px;
      --text: 15px;
    }
    * { box-sizing: border-box; }
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: "Noto Naskh Arabic", Arial, sans-serif;
      background: #0f172a;
    }
    /* Use small viewport height to avoid mobile browser UI issues */
    body { min-height: 100svh; display:flex; align-items:center; justify-content:center; }

    .phone {
      width: 100%;
      max-width: 480px;            /* a bit wider for bigger phones */
      height: 100svh;              /* fill the safe viewport height */
      background:#f8fafc;
      border-radius:20px;
      overflow:hidden;             /* clip header/topbar radius */
      box-shadow:0 8px 30px rgba(0,0,0,.4);
      display:flex; flex-direction:column;
    }

    header { background:#0ea5e9; color:#fff; padding:10px; text-align:center; font-weight:700; display:flex; flex-direction:column; align-items:center; gap:4px; font-size:13px; line-height:1.35; }
    header img { max-height:56px; width:auto; object-fit:contain; margin-bottom:4px; }
    header .subtitle { font-size:12px; font-weight:600; color:#e0f2fe; }

    .topbar { display:flex; gap:8px; align-items:center; justify-content:space-between; padding:8px 10px; background:#eef2f7; }
    .pill { background:#e2e8f0; border-radius:999px; padding:6px 10px; font-weight:700; font-size:13px; }
    #progressWrap{ height:6px; background:#e5e7eb; border-radius:999px; margin:0 10px 8px; overflow:hidden; }
    #progress{ height:100%; width:0%; background:#0ea5e9; transition:width .25s ease; }

    /* Make board scrollable if needed */
    .board { flex:1; display:flex; gap:var(--gap); padding:var(--pad); overflow:auto; }
    .col { flex:1; display:grid; grid-auto-rows:minmax(64px, 1fr); gap:var(--gap); }

    .card { background:#fff; border:2px solid #e2e8f0; border-radius:var(--card-radius); padding:var(--card-pad); text-align:center; font-size:var(--text); font-weight:800; user-select:none; box-shadow:0 3px 10px rgba(0,0,0,.06); }
    .card.small { font-weight:900; }
    .card.tap { cursor:pointer; }
    .card.selected { border-color:#3b82f6; background:#eff6ff; }
    .card.matched { background:#dcfce7 !important; border-color:#16a34a !important; color:#065f46; box-shadow:0 6px 18px rgba(22,163,74,.2); }
    .bad { animation: shake .35s linear; }

    @keyframes shake {
      10% { transform: translateX(-4px); }
      20% { transform: translateX(4px); }
      30% { transform: translateX(-4px); }
      40% { transform: translateX(4px); }
      50% { transform: translateX(-2px); }
      60% { transform: translateX(2px); }
      70% { transform: translateX(-1px); }
      80% { transform: translateX(1px); }
      90% { transform: translateX(0px); }
    }

    .overlay { position:fixed; inset:0; background:rgba(0,0,0,.45); display:none; align-items:center; justify-content:center; z-index:50; }
    .overlay.show { display:flex; }
    .modal { width:86%; max-width:360px; background:#fff; border-radius:18px; padding:16px; text-align:center; box-shadow:0 14px 48px rgba(0,0,0,.25); }
    .modal h2{ margin:0 0 8px; }
    .modal p{ margin:0 0 12px; color:#334155; }
    .btn { border:0; border-radius:10px; padding:10px 14px; font-weight:800; background:#0ea5e9; color:#fff; }

    /* ---------- Compact mode for very short screens ---------- */
    @media (max-height: 700px) {
      :root { --gap: 8px; --pad: 8px; --card-pad: 8px; --card-radius: 10px; --text: 14px; }
      header img { max-height:48px; }
    }
    @media (max-height: 620px) {
      :root { --gap: 6px; --pad: 6px; --card-pad: 6px; --card-radius: 10px; --text: 13px; }
      header { padding:8px; font-size:12px; }
      .pill { padding:4px 8px; font-size:12px; }
      #progressWrap { margin: 0 8px 6px; }
      .col { grid-auto-rows:minmax(56px, 1fr); }
    }
  </style>
</head>
<body>
  <div class="phone" id="app">
    <header>
      <img id="schoolLogo" src="school-logo.png" alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø¯Ø±Ø³Ø©" style="max-height:60px; width:auto; object-fit:contain; margin-bottom:4px;"/>
      Ø£Ø³Ø±Ø© Ù…Ø§Ø¯Ø© Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª Ø¨Ù…Ø¯Ø±Ø³Ø© Ø§Ù„ÙØ§Ø±ÙˆÙ‚ Ù„Ù„ØªØ¹Ù„ÙŠÙ… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ â€“ ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ø§Ù„Ø¨Ø±ÙŠÙ…ÙŠ
      <div class="subtitle">Ø§Ù„ØªÙ‚Ø±ÙŠØ¨ Ù„Ù„ØµÙ Ø§Ù„Ø«Ø§Ù…Ù† â€“ Ø·Ø§Ø¨Ù‚ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª</div>
    </header>

    <div class="topbar">
      <div class="pill">Ø§Ù„Ù…Ø³ØªÙˆÙ‰: <b id="level">Ù¡</b></div>
      <div class="pill">Ø§Ù„Ù†Ù‚Ø§Ø·: <b id="score">Ù </b></div>
      <button id="restart" class="btn" style="padding:6px 10px; font-size:12px;">Ø¥Ø¹Ø§Ø¯Ø©</button>
    </div>
    <div id="progressWrap"><div id="progress"></div></div>

    <div id="board" class="board" aria-live="polite">
      <div class="col" id="questionsCol" aria-label="Ø£Ø³Ø¦Ù„Ø©"></div>
      <div class="col" id="answersCol" aria-label="Ø¥Ø¬Ø§Ø¨Ø§Øª"></div>
    </div>

    <div id="finish" class="overlay" role="dialog" aria-modal="true">
      <div class="modal">
        <h2>ğŸ‰ Ø£Ø­Ø³Ù†Øª!</h2>
        <p id="finalDefault">Ø£Ù†Ù‡ÙŠØª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø²ÙˆØ§Ø¬. Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø­Ø§Ù„ÙŠ: <b id="finalLevel">Ù¡</b> â€“ Ù…Ø¬Ù…ÙˆØ¹ Ù†Ù‚Ø§Ø·Ùƒ: <b id="finalScore">Ù </b></p>
        <p id="finalMessage" style="display:none; font-weight:800; font-size:14px; color:#0f172a;">Ù…Ù…ØªØ§Ø² ÙŠØ§ Ø¨Ø·Ù„ Ù„Ù‚Ø¯ Ø§Ù†Ù‡ÙŠØª Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø¨Ù†Ø¬Ø§Ùƒ Ùˆ Ù†ØªÙŠØ¬ØªÙƒ Ù¢Ù  / Ù¢Ù </p>
        <div style="display:flex; gap:8px; justify-content:center; flex-wrap:wrap;">
          <button id="nextLevel" class="btn">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ§Ù„ÙŠ â®•</button>
          <button id="playAgain" class="btn" style="background:#10b981;">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø³ØªÙˆÙ‰</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // â€”â€”â€” Ø£Ø¯ÙˆØ§Øª Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ù‡Ù†Ø¯ÙŠØ© ÙˆÙØ§ØµÙ„ Ø¹Ø´Ø±ÙŠ Ø¹Ø±Ø¨ÙŠ â€”â€”â€”
    const HINDI = ['Ù ','Ù¡','Ù¢','Ù£','Ù¤','Ù¥','Ù¦','Ù§','Ù¨','Ù©'];
    const toHindi = (s)=> String(s).replace(/[0-9]/g, d=>HINDI[+d]).replaceAll('.', 'Ù«');

    // â€”â€”â€” Ù…ÙÙ‚Ø±Ù‘Ø¨Ø§Øª â€”â€”â€”
    const roundTo = (num, dp)=> Number(Math.round(num * 10**dp) / 10**dp).toFixed(dp);

    // â€”â€”â€” Ù…ÙÙ†ØªÙØ¬ Ù…Ø³ØªÙˆÙŠØ§Øª â€”â€”â€”
    // level 1: Ø«Ø§Ø¨Øª ÙƒÙ…Ø§ Ø§ØªÙÙ‚Ù†Ø§
    const LEVEL1 = [
      { id: 1, q: 'Ù‚Ø±Ù‘Ø¨ Ø§Ù„Ø¹Ø¯Ø¯ Ù¢Ù¥Ù«Ù¦Ù¨ Ø¥Ù„Ù‰ Ù…Ù†Ø²Ù„ØªÙŠÙ† Ø¹Ø´Ø±ÙŠØªÙŠÙ†', a: 'Ù¢Ù¥Ù«Ù¦Ù¨' },
      { id: 2, q: 'Ù‚Ø±Ù‘Ø¨ Ø§Ù„Ø¹Ø¯Ø¯ Ù£Ù«Ù¡Ù¤Ù¡Ù¥ Ø¥Ù„Ù‰ Ù…Ù†Ø²Ù„ØªÙŠÙ† Ø¹Ø´Ø±ÙŠØªÙŠÙ†', a: 'Ù£Ù«Ù¡Ù¤' },
      { id: 3, q: 'Ø¹Ø¨Ù‘Ø± Ø¹Ù† Ù Ù«Ù Ù Ù¤Ù¥Ù¢ Ø¨Ø±Ù‚Ù…ÙŠÙ† Ù…Ø¹Ù†ÙˆÙŠÙŠÙ†', a: 'Ù Ù«Ù Ù Ù¤Ù¥' },
      { id: 4, q: 'Ù‚Ø±Ù‘Ø¨ Ø§Ù„Ø¹Ø¯Ø¯ Ù¡Ù¨Ù«Ù£Ù§Ù¤ Ø¥Ù„Ù‰ Ù£ Ø£Ø±Ù‚Ø§Ù… Ù…Ø¹Ù†ÙˆÙŠØ©', a: 'Ù¡Ù¨Ù«Ù¤' },
      { id: 5, q: 'Ø¹Ø¨Ù‘Ø± Ø¹Ù† Ù¦Ù¥Ù§Ù© Ø¨Ø±Ù‚Ù…ÙŠÙ† Ù…Ø¹Ù†ÙˆÙŠÙŠÙ†', a: 'Ù¦Ù¦Ù Ù ' },
      { id: 6, q: 'Ù‚Ø±Ù‘Ø¨ Ø§Ù„Ø¹Ø¯Ø¯ Ù Ù«Ù©Ù©Ù©Ù¥ Ø¥Ù„Ù‰ Ù£ Ù…Ù†Ø§Ø²Ù„ Ø¹Ø´Ø±ÙŠØ©', a: 'Ù¡Ù«Ù Ù Ù ' },
    ];

    // level 2: Ø£Ø¹Ø¯Ø§Ø¯ Ø¹Ø´Ø±ÙŠØ© ØªØ¨Ø¯Ø£ Ø¨Ù€ Ù Ù«â€¦.. ÙˆÙ†ÙØ³ Ø§Ù„Ø¹Ø¯Ø¯ ÙŠÙØ·Ù„Ø¨ ØªÙ‚Ø±ÙŠØ¨ÙÙ‡ Ø¥Ù„Ù‰ Ù…Ù†Ø§Ø²Ù„ Ù…Ø®ØªÙ„ÙØ©
    function roundSig(num, sig){
      // Round number to specific significant figures and return string
      if (num === 0) return '0';
      const m = Math.pow(10, sig - Math.ceil(Math.log10(Math.abs(num))));
      const v = Math.round(num * m) / m;
      // Format with enough decimals to preserve sig figs
      const digits = Math.max(0, sig - Math.floor(Math.log10(Math.abs(v))) - 1);
      return v.toFixed(digits);
    }

    function makeLevel2(){
      // Ù†ÙˆÙ„Ù‘Ø¯ Ø¹Ø¯Ø¯Ø§Ù‹ Ø£Ø³Ø§Ø³ÙŠØ§Ù‹ 0.xxxxxx (Ù¦ Ù…Ù†Ø§Ø²Ù„) Ù„Ø²ÙŠØ§Ø¯Ø© ØªÙ†ÙˆÙ‘Ø¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ¨
      // ÙˆÙ†Ø¶Ù…Ù† Ø£Ù† Ù†ÙˆØ§ØªØ¬ Ø§Ù„ØªÙ‚Ø±ÙŠØ¨ Ø§Ù„Ù…Ø®ØªÙ„ÙØ© ØªÙƒÙˆÙ† Ù…Ù…ÙŠÙ‘Ø²Ø© (Ø¨Ø¯ÙˆÙ† ØªÙƒØ±Ø§Ø±)
      function build(){
        const x = Math.floor(100000 + Math.random()*900000); // 100000..999999
        const base = x / 1_000_000; // 0.xxxxxx
        const baseStr = toHindi(base.toFixed(6));

        const pairs = [];
        const answersSet = new Set();
        let nextId = 200; // Ù…Ø¹Ø±ÙØ§Øª ÙØ±ÙŠØ¯Ø© Ù„Ù„Ù…Ø³ØªÙˆÙ‰ Ù¢

        // 1) Ù…Ù†Ø§Ø²Ù„ Ø¹Ø´Ø±ÙŠØ© Ù…ØªØ¹Ø¯Ø¯Ø© (Ù†Ø®ØªØ§Ø± Ø­ØªÙ‰ Ù†Ø­ØµÙ„ Ø¹Ù„Ù‰ 6 Ù‚ÙŠÙÙ… Ù…Ø®ØªÙ„ÙØ© Ù‚Ø¨Ù„ SF)
        const candidatesDP = [1,2,3,4,5,6];
        for (let dp of candidatesDP){
          const ans = roundTo(base, dp); // string en-us with '.'
          if (!answersSet.has(ans)){
            answersSet.add(ans);
            const q = `Ù‚Ø±Ù‘Ø¨ Ø§Ù„Ø¹Ø¯Ø¯ ${baseStr} Ø¥Ù„Ù‰ ${toHindi(dp)} Ù…Ù†Ø²Ù„Ø© Ø¹Ø´Ø±ÙŠØ©`;
            pairs.push({ id: nextId++, q, a: toHindi(ans) });
          }
          if (pairs.length >= 6) break;
        }

        // 2) Ø±Ù‚Ù…Ù€Ø§Ù† Ù…Ø¹Ù†ÙˆÙŠØ§Ù† (SF): Ù¢ ÙˆÙ£ â€” Ù†Ø¶ÙŠÙ Ø¨Ø·Ø§Ù‚ØªÙŠÙ† Ø¥Ø¶Ø§ÙÙŠØªÙŠÙ†
        const sfs = [2,3];
        for (let sf of sfs){
          const ansSF = roundSig(base, sf); // returns with '.'
          // Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ±Ø§Ø± Ù…Ø¹ Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„Ù…Ù†Ø§Ø²Ù„ Ø§Ù„Ø¹Ø´Ø±ÙŠØ©
          if (!answersSet.has(ansSF)){
            answersSet.add(ansSF);
            const q = `Ù‚Ø±Ù‘Ø¨ Ø§Ù„Ø¹Ø¯Ø¯ ${baseStr} Ø¥Ù„Ù‰ ${toHindi(sf)} Ø£Ø±Ù‚Ø§Ù… Ù…Ø¹Ù†ÙˆÙŠØ©`;
            pairs.push({ id: nextId++, q, a: toHindi(ansSF) });
          }
        }

        // Ù†Ø±ÙŠØ¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ 8 Ø£Ø²ÙˆØ§Ø¬ (6 Ù…Ù†Ø§Ø²Ù„ Ø¹Ø´Ø±ÙŠØ© + 2 Ù…Ø¹Ù†ÙˆÙŠØ©). Ø¥Ù† Ù„Ù… Ù†ØµÙ„ Ø¨Ø³Ø¨Ø¨ Ø§Ù„ØªÙƒØ±Ø§Ø± Ù†Ø¹ÙŠØ¯ Ø§Ù„Ø¨Ù†Ø§Ø¡.
        return pairs.length >= 8 ? pairs : null;
      }

      let result = null; let guard = 0;
      while (!result && guard < 20){ result = build(); guard++; }
      return result || build();
    }

    // level 3 (Ø§Ø®ØªÙŠØ§Ø±ÙŠ Ù„Ø§Ø­Ù‚Ù‹Ø§): Ù…Ù…ÙƒÙ† Ù†Ø®Ù„ÙŠÙ‡ Ø£Ø¹Ø¯Ø§Ø¯ Ù…Ø«Ù„ Ù¡Ù¢Ù«Ù Ù Ù£Ù¤ Ù…Ø¹ Ø·Ù„Ø¨ Ù…Ù†Ø§Ø²Ù„/Ø£Ø±Ù‚Ø§Ù… Ù…Ø¹Ù†ÙˆÙŠØ© Ù…ØªÙ†ÙˆØ¹Ø©.

    // level 3 (Ø§Ø®ØªÙŠØ§Ø±ÙŠ Ù„Ø§Ø­Ù‚Ù‹Ø§): Ù…Ù…ÙƒÙ† Ù†Ø®Ù„ÙŠÙ‡ Ø£Ø¹Ø¯Ø§Ø¯ Ù…Ø«Ù„ Ù¡Ù¢Ù«Ù Ù Ù£Ù¤ Ù…Ø¹ Ø·Ù„Ø¨ Ù…Ù†Ø§Ø²Ù„/Ø£Ø±Ù‚Ø§Ù… Ù…Ø¹Ù†ÙˆÙŠØ© Ù…ØªÙ†ÙˆØ¹Ø©.

    // â€”â€”â€” Ø­Ø§Ù„Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© â€”â€”â€”
    let currentLevel = 1;
    let PAIRS = LEVEL1.slice();
    let selectedQ = null; // id Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ù…Ø®ØªØ§Ø±
    let selectedA = null; // id Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©
    let matched = new Set();
    let score = 0;

    const $ = s => document.querySelector(s);
    const $$ = s => Array.from(document.querySelectorAll(s));
    const qCol = $('#questionsCol');
    const aCol = $('#answersCol');

    function updateHUD(){
      $('#level').textContent = toHindi(currentLevel);
      $('#score').textContent = toHindi(score);
      const pct = Math.round( (matched.size / PAIRS.length) * 100 );
      $('#progress').style.width = pct + '%';
    }

    function resetSelection(){
      selectedQ = null; selectedA = null;
      $$('.card.selected').forEach(c=>c.classList.remove('selected'));
    }

    function showFinish(){
      const def = document.getElementById('finalDefault');
      const msg = document.getElementById('finalMessage');

      // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù„Ø®Øµ Ø§Ù„Ø¹Ø§Ù… Ø¯Ø§Ø¦Ù…Ø§Ù‹
      document.getElementById('finalLevel').textContent = toHindi(currentLevel);
      document.getElementById('finalScore').textContent = toHindi(score);

      if (currentLevel === 2){
        def.style.display = 'none';
        msg.textContent = 'Ù…Ù…ØªØ§Ø² ÙŠØ§ Ø¨Ø·Ù„ Ù„Ù‚Ø¯ Ø§Ù†Ù‡ÙŠØª Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø«Ø§Ù†ÙŠ Ø¨Ù†Ø¬Ø§Ùƒ Ùˆ Ù†ØªÙŠØ¬ØªÙƒ Ù¢Ù  / Ù¢Ù ';
        msg.style.display = 'block';
        // ÙÙŠ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ù¢ Ù†Ø®ÙÙŠ Ø²Ø± Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ§Ù„ÙŠ
        const nl = document.getElementById('nextLevel');
        if (nl) nl.style.display = 'none';
      } else {
        def.style.display = 'block';
        msg.style.display = 'none';
        const nl = document.getElementById('nextLevel');
        if (nl) nl.style.display = 'inline-block';
      }
      document.getElementById('finish').classList.add('show');
    } else {
        def.style.display = 'block';
        msg.style.display = 'none';
      }
      document.getElementById('finish').classList.add('show');

      // Ø§Ù†ØªÙ‚Ø§Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù…Ù† Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 1 Ø¥Ù„Ù‰ 2 Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØ© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ Ø¨Ø¬Ø§Ù†Ø¨ Ø§Ù„Ø²Ø±)
      if (currentLevel === 1){
        setTimeout(()=>{
          const overlay = document.getElementById('finish');
          if (overlay.classList.contains('show')){
            overlay.classList.remove('show');
            nextLevel();
          }
        }, 1000);
      }
    }
      document.getElementById('finish').classList.add('show');
    }

    function tryMatch(){
      if(!selectedQ || !selectedA) return;
      const qEl = $(`#questionsCol .card[data-id="${selectedQ}"]`);
      const aEl = $(`#answersCol .card[data-id="${selectedA}"]`);
      if (selectedQ === selectedA){
        qEl.classList.add('matched');
        aEl.classList.add('matched');
        qEl.style.pointerEvents = 'none';
        aEl.style.pointerEvents = 'none';
        matched.add(selectedQ);
        score += 1;
        updateHUD();
        resetSelection();
        if (matched.size === PAIRS.length){ showFinish(); }
      } else {
        qEl.classList.add('bad'); aEl.classList.add('bad');
        setTimeout(()=>{ qEl.classList.remove('bad'); aEl.classList.remove('bad'); }, 350);
        resetSelection();
      }
    }

    function tapQuestion(card){
      if (card.classList.contains('matched')) return;
      $$('#questionsCol .card').forEach(c=>c.classList.remove('selected'));
      card.classList.add('selected');
      selectedQ = parseInt(card.dataset.id,10);
      tryMatch();
    }

    function tapAnswer(card){
      if (card.classList.contains('matched')) return;
      $$('#answersCol .card').forEach(c=>c.classList.remove('selected'));
      card.classList.add('selected');
      selectedA = parseInt(card.dataset.id,10);
      tryMatch();
    }

    function shuffle(arr){ return arr.map(x=>[Math.random(),x]).sort((a,b)=>a[0]-b[0]).map(x=>x[1]); }

    function render(){
      qCol.innerHTML = ''; aCol.innerHTML = '';
      const answers = shuffle(PAIRS);
      PAIRS.forEach(p=>{
        const qc = document.createElement('div');
        qc.className = 'card tap'; qc.dataset.id = String(p.id); qc.textContent = p.q;
        qc.addEventListener('click', ()=>tapQuestion(qc));
        qCol.appendChild(qc);
      });
      answers.forEach(p=>{
        const ac = document.createElement('div');
        ac.className = 'card tap small'; ac.dataset.id = String(p.id); ac.textContent = p.a;
        ac.addEventListener('click', ()=>tapAnswer(ac));
        aCol.appendChild(ac);
      });
    }

    function startLevel(level){
      // Ø¨Ø¯Ø¡ Ù…Ø³ØªÙˆÙ‰ Ø¬Ø¯ÙŠØ¯
      currentLevel = level;
      matched.clear();
      score = 0;
      resetSelection();

      // ØªØ­Ø¯ÙŠØ¯ Ø£Ø²ÙˆØ§Ø¬ Ø§Ù„Ù…Ø±Ø­Ù„Ø©
      PAIRS = (level === 1) ? LEVEL1.slice() : makeLevel2();

      // Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© ÙˆØ¥Ø®ÙØ§Ø¡ Ø§Ù„Ù†Ø§ÙØ°Ø©
      const overlay = document.getElementById('finish');
      overlay.classList.remove('show');
      document.getElementById('progress').style.width = '0%';
      updateHUD();

      // ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ù„ÙˆØ­
      render();

      // ØªÙ…Ø±ÙŠØ± ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ø£Ø¹Ù„Ù‰ Ø§Ù„Ù„ÙˆØ­Ø© (Ù…ÙÙŠØ¯ Ù„Ù„Ø¬ÙˆØ§Ù„)
      const board = document.getElementById('board');
      board.scrollTop = 0;
    }

    function nextLevel(){
      // Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„ØµØ±ÙŠØ­ Ù„Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ§Ù„ÙŠ
      if (currentLevel === 1){ startLevel(2); }
      else { startLevel(1); }
    }
    }

    // Ø£Ø²Ø±Ø§Ø±
    $('#restart').addEventListener('click', ()=>startLevel(currentLevel));
    $('#playAgain').addEventListener('click', ()=>startLevel(currentLevel));
    $('#nextLevel').addEventListener('click', ()=>{
      document.getElementById('finish').classList.remove('show');
      nextLevel();
    }); nextLevel(); });

    // ØªØ´ØºÙŠÙ„ Ø£ÙˆÙ„ÙŠ
    startLevel(1);

    // â€”â€”â€” Ù…Ø­Ù…Ù‘Ù„ Ø´Ø¹Ø§Ø± Ù…Ø±Ù† Ù…Ø¹ Ø¹Ø¯Ø© Ø£Ø³Ù…Ø§Ø¡/Ù…Ø³Ø§Ø±Ø§Øª + Ø¯Ø¹Ù… ?logo= â€”â€”
    (function(){
      const params = new URLSearchParams(location.search);
      const provided = params.get('logo');
      const candidates = provided ? [decodeURIComponent(provided)] : [
        'school-logo.png','logo.png','logo.jpg','logo.jpeg','logo.webp',
        'images/school-logo.png','images/logo.png','images/logo.jpg','images/logo.webp'
      ];
      const el = document.getElementById('schoolLogo');
      function tryNext(i){
        if(i >= candidates.length){ el.style.display='none'; return; }
        const test = new Image();
        test.onload = ()=>{ el.src = candidates[i] + '?v=' + Date.now(); el.style.display='block'; };
        test.onerror = ()=> tryNext(i+1);
        test.src = candidates[i] + '?probe=' + Math.random();
      }
      tryNext(0);
    })();
    // ØªØ£ÙƒÙŠØ¯ Ø±Ø¨Ø· Ø²Ø± Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ§Ù„ÙŠ (Ø­ØªÙ‰ Ù„Ùˆ ØªØºÙŠÙ‘Ø± ØªØ±ØªÙŠØ¨ Ø§Ù„Ø³ÙƒØ±Ø¨Øª)
  (function(){
    const bind = ()=>{
      const btn = document.getElementById('nextLevel');
      if (btn){ btn.onclick = ()=>{ document.getElementById('finish').classList.remove('show'); nextLevel(); }; }
    };
    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', bind); else bind();
  })();
  // --- Ø­Ø§Ø±Ø³ Ø£Ù…Ø§Ù† Ù„Ø¥Ø¸Ù‡Ø§Ø± Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø£ÙˆÙ„ Ø¥Ø°Ø§ Ø§Ø®ØªÙØª Ø¨Ø·Ø±ÙŠÙ‚ Ø§Ù„Ø®Ø·Ø£ ---
  window.addEventListener('error', (e)=>{ console.error('JS Error:', e.message); });
  (function safety(){
    try{
      // ØªØ£ÙƒØ¯ Ù…Ù† Ø¥ØºÙ„Ø§Ù‚ Ù†Ø§ÙØ°Ø© Ø§Ù„Ù†Ù‡Ø§ÙŠØ©
      const overlay = document.getElementById('finish');
      if (overlay) overlay.classList.remove('show');
      // Ø¥Ø°Ø§ Ù„Ù… ØªÙØ¬Ù‡Ù‘ÙØ² Ø§Ù„Ø£Ø²ÙˆØ§Ø¬ Ù„Ø£ÙŠ Ø³Ø¨Ø¨ØŒ Ø§Ø±Ø¬Ø¹ Ù„Ù„Ù…Ø³ØªÙˆÙ‰ Ù¡ ÙˆØ£Ø¹Ø¯ Ø§Ù„Ø±Ø³Ù…
      if (!window.PAIRS || !Array.isArray(PAIRS) || !PAIRS.length){
        if (Array.isArray(window.LEVEL1)) { window.PAIRS = window.LEVEL1.slice(); }
      }
      // Ø¥Ø°Ø§ Ù„Ù… ØªÙÙ†Ø´Ø£ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª ÙÙŠ Ø§Ù„Ø¹Ù…ÙˆØ¯ÙŠÙ†ØŒ Ø£Ø¬Ø±Ù render ÙŠØ¯ÙˆÙŠÙ‹Ø§
      const qCol = document.getElementById('questionsCol');
      const aCol = document.getElementById('answersCol');
      if (qCol && aCol && qCol.children.length === 0 && typeof window.render === 'function'){
        window.render();
      }
      // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø²Ø± Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ§Ù„ÙŠ Ø§Ø­ØªÙŠØ§Ø·Ù‹Ø§
      const nl = document.getElementById('nextLevel');
      if (nl && !nl.dataset.bound){
        nl.addEventListener('click', ()=>{ const ov = document.getElementById('finish'); if (ov) ov.classList.remove('show'); if (typeof window.nextLevel==='function') window.nextLevel(); });
        nl.dataset.bound = '1';
      }
    }catch(err){ console.error('Safety init failed:', err); }
  })();
</script>
<script>
    // Auto-compact on very small viewport heights (dynamic)
    (function(){
      function applyCompact(){
        const h = window.innerHeight;
        document.documentElement.style.setProperty('--text', h < 620 ? '13px' : (h < 700 ? '14px' : '15px'));
      }
      window.addEventListener('resize', applyCompact);
      applyCompact();
    })();
  </script>
</body>
</html>
